import{r as P,R as Z,j}from"./index-lxRjVWda.js";var h={BASE_URL:"/my-dashboard/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};let Q=0;function tt(e,i){const a=`atom${++Q}`,p={toString:()=>a};return typeof e=="function"?p.read=e:(p.init=e,p.read=function(w){return w(this)},p.write=function(w,g,A){return g(this,typeof A=="function"?A(w(this)):A)}),i&&(p.write=i),p}const B=e=>"init"in e,D=e=>!!e.write,N=new WeakMap,et=(e,i)=>{N.set(e,i),e.catch(()=>{}).finally(()=>N.delete(e))},W=(e,i)=>{const a=N.get(e);a&&(N.delete(e),a(i))},q=(e,i)=>{e.status="fulfilled",e.value=i},$=(e,i)=>{e.status="rejected",e.reason=i},nt=e=>typeof(e==null?void 0:e.then)=="function",R=(e,i)=>!!e&&"v"in e&&"v"in i&&Object.is(e.v,i.v),G=(e,i)=>!!e&&"e"in e&&"e"in i&&Object.is(e.e,i.e),M=e=>!!e&&"v"in e&&e.v instanceof Promise,ot=(e,i)=>"v"in e&&"v"in i&&e.v.orig&&e.v.orig===i.v.orig,T=e=>{if("e"in e)throw e.e;return e.v},rt=()=>{const e=new WeakMap,i=new WeakMap,a=new Map;let p,w;(h?"production":void 0)!=="production"&&(p=new Set,w=new Set);const g=t=>e.get(t),A=(t,o)=>{(h?"production":void 0)!=="production"&&Object.freeze(o);const s=e.get(t);if(e.set(t,o),a.has(t)||a.set(t,s),M(s)){const n="v"in o?o.v instanceof Promise?o.v:Promise.resolve(o.v):Promise.reject(o.e);s.v!==n&&W(s.v,n)}},S=(t,o,s)=>{const n=new Map;let c=!1;s.forEach((d,r)=>{!d&&r===t&&(d=o),d?(n.set(r,d),o.d.get(r)!==d&&(c=!0)):(h?"production":void 0)!=="production"&&console.warn("[Bug] atom state not found")}),(c||o.d.size!==n.size)&&(o.d=n)},y=(t,o,s)=>{const n=g(t),c={d:(n==null?void 0:n.d)||new Map,v:o};if(s&&S(t,c,s),R(n,c)&&n.d===c.d)return n;if(M(n)&&M(c)&&ot(n,c)){if(n.d===c.d)return n;c.v=n.v}return A(t,c),c},E=(t,o,s,n)=>{if(nt(o)){let c;const d=()=>{const u=g(t);if(!M(u)||u.v!==r)return;const v=y(t,r,s);i.has(t)&&u.d!==v.d&&L(t,v,u.d)},r=new Promise((u,v)=>{let l=!1;o.then(f=>{l||(l=!0,q(r,f),u(f),d())},f=>{l||(l=!0,$(r,f),v(f),d())}),c=f=>{l||(l=!0,f.then(_=>q(r,_),_=>$(r,_)),u(f))}});return r.orig=o,r.status="pending",et(r,u=>{u&&c(u),n==null||n()}),y(t,r,s)}return y(t,o,s)},m=(t,o,s)=>{const n=g(t),c={d:(n==null?void 0:n.d)||new Map,e:o};return s&&S(t,c,s),G(n,c)&&n.d===c.d?n:(A(t,c),c)},b=(t,o)=>{const s=g(t);if(!o&&s&&(i.has(t)||Array.from(s.d).every(([l,f])=>{if(l===t)return!0;const _=b(l);return _===f||R(_,f)})))return s;const n=new Map;let c=!0;const d=l=>{if(l===t){const _=g(l);if(_)return n.set(l,_),T(_);if(B(l))return n.set(l,void 0),l.init;throw new Error("no atom init")}const f=b(l);return n.set(l,f),T(f)};let r,u;const v={get signal(){return r||(r=new AbortController),r.signal},get setSelf(){return(h?"production":void 0)!=="production"&&!D(t)&&console.warn("setSelf function cannot be used with read-only atom"),!u&&D(t)&&(u=(...l)=>{if((h?"production":void 0)!=="production"&&c&&console.warn("setSelf function cannot be called in sync"),!c)return C(t,...l)}),u}};try{const l=t.read(d,v);return E(t,l,n,()=>r==null?void 0:r.abort())}catch(l){return m(t,l,n)}finally{c=!1}},x=t=>T(b(t)),K=t=>{let o=i.get(t);return o||(o=k(t)),o},V=(t,o)=>!o.l.size&&(!o.t.size||o.t.size===1&&o.t.has(t)),X=t=>{const o=i.get(t);o&&V(t,o)&&I(t)},z=t=>{const o=new Map,s=new WeakMap,n=r=>{var u;const v=new Set((u=i.get(r))==null?void 0:u.t);return a.forEach((l,f)=>{var _;(_=g(f))!=null&&_.d.has(r)&&v.add(f)}),v},c=r=>{n(r).forEach(u=>{u!==r&&(o.set(u,(o.get(u)||new Set).add(r)),s.set(u,(s.get(u)||0)+1),c(u))})};c(t);const d=r=>{n(r).forEach(u=>{var v;if(u!==r){let l=s.get(u);if(l&&s.set(u,--l),!l){let f=!!((v=o.get(u))!=null&&v.size);if(f){const _=g(u),Y=b(u,!0);f=!R(_,Y)}f||o.forEach(_=>_.delete(u))}d(u)}})};d(t)},F=(t,...o)=>{let s=!0;const n=r=>T(b(r)),c=(r,...u)=>{let v;if(r===t){if(!B(r))throw new Error("atom not writable");const l=g(r),f=E(r,u[0]);R(l,f)||z(r)}else v=F(r,...u);if(!s){const l=O();(h?"production":void 0)!=="production"&&p.forEach(f=>f({type:"async-write",flushed:l}))}return v},d=t.write(n,c,...o);return s=!1,d},C=(t,...o)=>{const s=F(t,...o),n=O();return(h?"production":void 0)!=="production"&&p.forEach(c=>c({type:"write",flushed:n})),s},k=(t,o,s)=>{var n;const c=s||[];(n=g(t))==null||n.d.forEach((r,u)=>{const v=i.get(u);v?v.t.add(t):u!==t&&k(u,t,c)}),b(t);const d={t:new Set(o&&[o]),l:new Set};if(i.set(t,d),(h?"production":void 0)!=="production"&&w.add(t),D(t)&&t.onMount){const{onMount:r}=t;c.push(()=>{const u=r((...v)=>C(t,...v));u&&(d.u=u)})}return s||c.forEach(r=>r()),d},I=t=>{var o;const s=(o=i.get(t))==null?void 0:o.u;s&&s(),i.delete(t),(h?"production":void 0)!=="production"&&w.delete(t);const n=g(t);n?(M(n)&&W(n.v),n.d.forEach((c,d)=>{if(d!==t){const r=i.get(d);r&&(r.t.delete(t),V(d,r)&&I(d))}})):(h?"production":void 0)!=="production"&&console.warn("[Bug] could not find atom state to unmount",t)},L=(t,o,s)=>{const n=new Set(o.d.keys());s==null||s.forEach((c,d)=>{if(n.has(d)){n.delete(d);return}const r=i.get(d);r&&(r.t.delete(t),V(d,r)&&I(d))}),n.forEach(c=>{const d=i.get(c);d?d.t.add(t):i.has(t)&&k(c,t)})},O=()=>{let t;for((h?"production":void 0)!=="production"&&(t=new Set);a.size;){const o=Array.from(a);a.clear(),o.forEach(([s,n])=>{const c=g(s);if(c){const d=i.get(s);d&&c.d!==(n==null?void 0:n.d)&&L(s,c,n==null?void 0:n.d),d&&!(!M(n)&&(R(n,c)||G(n,c)))&&(d.l.forEach(r=>r()),(h?"production":void 0)!=="production"&&t.add(s))}else(h?"production":void 0)!=="production"&&console.warn("[Bug] no atom state to flush")})}if((h?"production":void 0)!=="production")return t},J=(t,o)=>{const s=K(t),n=O(),c=s.l;return c.add(o),(h?"production":void 0)!=="production"&&p.forEach(d=>d({type:"sub",flushed:n})),()=>{c.delete(o),X(t),(h?"production":void 0)!=="production"&&p.forEach(d=>d({type:"unsub"}))}};return(h?"production":void 0)!=="production"?{get:x,set:C,sub:J,dev_subscribe_store:(t,o)=>{if(o!==2)throw new Error("The current StoreListener revision is 2.");return p.add(t),()=>{p.delete(t)}},dev_get_mounted_atoms:()=>w.values(),dev_get_atom_state:t=>e.get(t),dev_get_mounted:t=>i.get(t),dev_restore_atoms:t=>{for(const[s,n]of t)B(s)&&(E(s,n),z(s));const o=O();p.forEach(s=>s({type:"restore",flushed:o}))}}:{get:x,set:C,sub:J}};let U;(h?"production":void 0)!=="production"&&(typeof globalThis.__NUMBER_OF_JOTAI_INSTANCES__=="number"?++globalThis.__NUMBER_OF_JOTAI_INSTANCES__:globalThis.__NUMBER_OF_JOTAI_INSTANCES__=1);const st=()=>(U||((h?"production":void 0)!=="production"&&globalThis.__NUMBER_OF_JOTAI_INSTANCES__!==1&&console.warn("Detected multiple Jotai instances. It may cause unexpected behavior with the default store. https://github.com/pmndrs/jotai/discussions/2044"),U=rt()),U);var it={BASE_URL:"/my-dashboard/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const ct=P.createContext(void 0),H=e=>{const i=P.useContext(ct);return(e==null?void 0:e.store)||i||st()},ut=e=>typeof(e==null?void 0:e.then)=="function",dt=Z.use||(e=>{if(e.status==="pending")throw e;if(e.status==="fulfilled")return e.value;throw e.status==="rejected"?e.reason:(e.status="pending",e.then(i=>{e.status="fulfilled",e.value=i},i=>{e.status="rejected",e.reason=i}),e)});function lt(e,i){const a=H(i),[[p,w,g],A]=P.useReducer(E=>{const m=a.get(e);return Object.is(E[0],m)&&E[1]===a&&E[2]===e?E:[m,a,e]},void 0,()=>[a.get(e),a,e]);let S=p;(w!==a||g!==e)&&(A(),S=a.get(e));const y=i==null?void 0:i.delay;return P.useEffect(()=>{const E=a.sub(e,()=>{if(typeof y=="number"){setTimeout(A,y);return}A()});return A(),E},[a,e,y]),P.useDebugValue(S),ut(S)?dt(S):S}function ft(e,i){const a=H(i);return P.useCallback((...w)=>{if((it?"production":void 0)!=="production"&&!("write"in e))throw new Error("not writable atom");return a.set(e,...w)},[a,e])}function at(e,i){return[lt(e,i),ft(e,i)]}const vt=tt(0),pt=()=>{const[e,i]=at(vt);return j.jsxs(j.Fragment,{children:[j.jsx("p",{children:e}),j.jsx("button",{onClick:()=>{i(e+1)},children:"Add count"})]})};export{pt as default};
